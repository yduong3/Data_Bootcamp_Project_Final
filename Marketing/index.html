<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Data Driven Marketing Analysis</title>
	<meta name="description" content="Data Driven Marketing Analysis by Yen Duong" />
	<meta name="keywords" content="marketing, data, analysis" />
	<meta name="author" content="Yen Duong" />
	<!-- Favicons (created with http://realfavicongenerator.net/)-->
	<link rel="apple-touch-icon" sizes="180x180" href="img/favicons/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="img/favicons/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="img/favicons/favicon-16x16.png">
	<link rel="manifest" href="/site.webmanifest">
	<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
	<meta name="msapplication-TileColor" content="#da532c">
	<meta name="theme-color" content="#ffffff">
	<!-- Normalize -->
	<link rel="stylesheet" type="text/css" href="css/normalize.css">
	<!-- Bootstrap -->
	<link rel="stylesheet" type="text/css" href="css/bootstrap.css">
	<!-- Animate.css -->
	<link rel="stylesheet" type="text/css" href="css/animate.css">
	<!-- Font Awesome -->
	<link rel="stylesheet" type="text/css" href="fonts/font-awesome-4.1.0/css/font-awesome.min.css">
	<!-- Elegant Icons -->
	<link rel="stylesheet" type="text/css" href="fonts/eleganticons/et-icons.css">
	<!-- Main style -->
	<link rel="stylesheet" type="text/css" href="css/mrkcht.css">
	<link rel="stylesheet" type="text/css" href="css/vim.css">
</head>

<body>
	<div class="preloader">
		<img src="img/loader.gif" alt="Preloader image">
	</div>
	<nav class="navbar">
		<div class="container">
			<!-- Brand and toggle get grouped for better mobile display -->
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
					<span class="sr-only">Toggle navigation</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="#"><img src="img/logo.png" data-active-url="img/logo.png" alt=""></a>
			</div>
			<!-- Collect the nav links, forms, and other content for toggling -->
			<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
				<ul class="nav navbar-nav navbar-right main-nav">
					<li><a href="#intro"></a></li>
					<li><a href="#sales">Sales Analysis</a></li>
					<li><a href="#customers">Customer Analysis</a></li>
					<li><a href="#customerseg">Customer Segmentation</a></li>
					<li><a href="#salesfor">Sales Forcast</a></li>
				</ul>
			</div>
			<!-- /.navbar-collapse -->
		</div>
		<!-- /.container-fluid -->
	</nav>
	<header id="intro">
		<div class="container">
			<div class="table">
				<div class="header-text">
					<div class="row">
						<div class="col-md-12 text-center">
							<!-- <h3 class="light white">Take care of your body.</h3> -->
							<h1 class="white typed">Data Driven Marketing Analysis.</h1>
							<span class="typed-cursor">|</span>
						</div>
					</div>
				</div>
			</div>
		</div>
	</header>
	<!-- Sales Analysis -->
	<section id="sales" class="section section-padded">
		<div class="container">
			<div class="row text-center title">
				<h2>Sales Analysis</h2>
				<h4 class="light muted"></h4>
			</div>
			<div class="row sales">
				<div class="col-md-10 column-in-center">
					<p>This analysis is done using an online retail dataset that was downloaded from <a href="http://archive.ics.uci.edu/ml/datasets/online+retail" target="_blank">UCI Machine Learning Repository</a>.</p>
					<p>Start by importing our libraries and then loading the data.</p>
					<div class="cell border-box-sizing code_cell rendered">
						<div class="input">
							<div class="inner_cell">
								<div class="input_area">
									<div class=" highlight hl-ipython3">
										<pre><span></span><span class="c1"># import libraries</span>
<span class="kn">import</span> <span class="nn">datetime</span> <span class="k">as</span> <span class="nn">dt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># ML models</span>
<span class="kn">from</span> <span class="nn">fbprophet</span> <span class="k">import</span> <span class="n">Prophet</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span><span class="p">,</span> <span class="n">mean_absolute_error</span>

<span class="c1"># never print matching warnings</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">'ignore'</span><span class="p">)</span>

<span class="c1"># classic division semantics in a module</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">division</span>

<span class="c1">#for data visualization</span>
<span class="kn">import</span> <span class="nn">plotly.offline</span> <span class="k">as</span> <span class="nn">pyoff</span>
<span class="kn">from</span> <span class="nn">plotly.offline</span> <span class="k">import</span> <span class="n">download_plotlyjs</span><span class="p">,</span> <span class="n">init_notebook_mode</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">iplot</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objs</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># initiate the Plotly Notebook mode to use plotly offline</span>
<span class="n">init_notebook_mode</span><span class="p">(</span><span class="n">connected</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre>
										</div>
									</div>
								</div>
							</div>
							<div class="input">
								<div class="inner_cell">
									<div class="input_area">
										<div class=" highlight hl-ipython3">
											<pre><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;OnlineRetail.csv&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;unicode_escape&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span></pre>
											</div>
											<div class="image" style="width: 1236px; height: auto; max-width: 100%;">
												<img alt="sales dataframe" src="img/data_df.jpg" class="center-block" style="width: 1236px; height: auto; max-width: 100%;"/>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="row sales">
						<div class="col-md-10 column-in-center">
							<p>Check the full summary to see if cleaning is needed and what explore what tytpes are in this dataset.</p>
							<div class="cell border-box-sizing code_cell rendered">
								<div class="input">
									<div class="inner_cell">
										<div class="input_area">
											<div class=" highlight hl-ipython3">
												<pre><span class="n">data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span></pre>
											</div>
											<div class="image" style="width: 350px; height: auto;">
												<img alt="data_describe" src="img/data_describe.jpg" class="center-block" style="width: 350px; height: auto;"/>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
		<div class="row sales">
		<div class="col-md-10 column-in-center">
			<p>Removed all the nulls, dups and negative values.
				Now convert InvoiceDate to datetime from string and add in InvoicePeriod to determine invoice month.</p>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-ipython3">
								<pre><span class="n">retail_data</span><span class="p">[</span><span class="s1">'InvoiceDate'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">retail_data</span><span class="p">[</span><span class="s1">'InvoiceDate'</span><span class="p">])</span>
<span class="n">retail_data</span><span class="p">[</span><span class="s1">'InvoicePeriod'</span><span class="p">]</span> <span class="o">=</span> <span class="n">retail_data</span><span class="p">[</span><span class="s1">'InvoiceDate'</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">'%Y-%m'</span><span class="p">))</span>
<span class="n">retail_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span></pre>
							</div>
							<div class="image" style="width: 1236px; height: auto; max-width: 100%;">
								<img alt="sales dataframe" src="img/retail_data.jpg" class="center-block" style="width: 1236px; height: auto; max-width: 100%;"/>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="row sales">
		<div class="col-md-10 column-in-center">
			<p>Calculate monthly revenue and create a new dataframe with InvoicePeriod and Revenue columns.</p>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-ipython3">
							<pre><span class="n">retail_data</span><span class="p">[</span><span class="s1">'Revenue'</span><span class="p">]</span> <span class="o">=</span> <span class="n">retail_data</span><span class="p">[</span><span class="s1">'UnitPrice'</span><span class="p">]</span> <span class="o">*</span> <span class="n">retail_data</span><span class="p">[</span><span class="s1">'Quantity'</span><span class="p">]</span>
<span class="n">retail_revenue</span> <span class="o">=</span> <span class="n">retail_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">'InvoicePeriod'</span><span class="p">])[</span><span class="s1">'Revenue'</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">revenue</span> <span class="o">=</span> <span class="n">retail_revenue</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">retail_revenue</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">12</span><span class="p">])</span>
<span class="n">revenue</span></pre>
							</div>
							<div class="image" style="width: 225px; height: auto; max-width: 100%;">
								<img alt="sales dataframe" src="img/retail_revenue.jpg" class="center-block" style="width: 225px; height: auto; max-width: 100%;"/>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="row sales">
		<div class="col-md-10 column-in-center">
			<p>Graph monthly revenue.</p>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-ipython3">
								<pre><span class="n">revenue_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">revenue</span><span class="p">[</span><span class="s1">'InvoicePeriod'</span><span class="p">],</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">revenue</span><span class="p">[</span><span class="s1">'Revenue'</span><span class="p">])]</span>

<span class="n">plot_layout</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">xaxis</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s1">'Date'</span><span class="p">,</span> <span class="nb">type</span> <span class="o">=</span> <span class="s1">'category'</span><span class="p">),</span>
<span class="n">yaxis</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'title'</span><span class="p">:</span><span class="s1">'Revenue $'</span><span class="p">},</span>
<span class="n">title</span> <span class="o">=</span> <span class="s1">'Total Monthly Revenue'</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">revenue_data</span><span class="p">,</span> <span class="n">layout</span> <span class="o">=</span> <span class="n">plot_layout</span><span class="p">)</span>
<span class="n">pyoff</span><span class="o">.</span><span class="n">iplot</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span></pre>
							</div>
							<div class="image" style="width: 1236px; height: auto; max-width: 100%;">
								<img alt="sales dataframe" src="img/month_rev_graph.jpg" class="center-block" style="width: 1236px; height: auto; max-width: 100%;"/>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="row sales">
		<div class="col-md-10 column-in-center">
			<p>Calculate monthly revenue growth rate using pct_change() function to see monthly percentage change.</p>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-ipython3">
								<pre><span class="n">revenue</span><span class="p">[</span><span class="s1">'MonthlyGrowth%'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">retail_revenue</span><span class="p">[</span><span class="s1">'Revenue'</span><span class="p">]</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">()</span>
<span class="n">growth</span> <span class="o">=</span> <span class="n">revenue</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">growth</span></pre>
							</div>
							<div class="image" style="width: 325px; height: auto; max-width: 100%;">
								<img alt="sales dataframe" src="img/growth_rate.jpg" class="center-block" style="width: 325px; height: auto; max-width: 100%;"/>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="row sales">
		<div class="col-md-10 column-in-center">
			<p>Graph monthly revenue growth rate.</p>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-ipython3">
									<pre><span class="n">mrg_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">growth</span><span class="p">[</span><span class="s1">'InvoicePeriod'</span><span class="p">],</span>
		       <span class="n">y</span> <span class="o">=</span> <span class="n">growth</span><span class="p">[</span><span class="s1">'MonthlyGrowth%'</span><span class="p">])]</span>

<span class="n">plot_layout</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">xaxis</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s1">'Date'</span><span class="p">,</span> <span class="nb">type</span> <span class="o">=</span> <span class="s1">'category'</span><span class="p">),</span>
			<span class="n">yaxis</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'title'</span><span class="p">:</span><span class="s1">'Growth %'</span><span class="p">},</span>
			<span class="n">title</span> <span class="o">=</span> <span class="s1">'Monthly Revenue Growth Rate'</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">mrg_data</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">plot_layout</span><span class="p">)</span>
<span class="n">pyoff</span><span class="o">.</span><span class="n">iplot</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span></pre>
							</div>
							<div class="image" style="width: 1236px; height: auto; max-width: 100%;">
								<img alt="sales dataframe" src="img/graph_growth_rate.jpg" class="center-block" style="width: 1236px; height: auto; max-width: 100%;"/>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	</div>
	<div class="cut cut-bottom"></div>
	</section>

	<!-- Customer Analysis -->
	<section id="customers" class="section gray-bg">
		<div class="container">
			<div class="row title text-center">
				<h2 class="margin-top">Customer Analysis</h2>
				<h4 class="light muted"></h4>
			</div>
			<div class="row customers">
				<div class="col-md-10 column-in-center">
					<p>Now let's take a closer look at the customers.</p>
					<p>Groupby customer ID and using the .min() function to find customers' first purchase date based on 
						InvoiceDate coloumn and created a dataframe contaning CustomerID and first purchase date</p>
					<div class="cell border-box-sizing code_cell rendered">
						<div class="input">
							<div class="inner_cell">
								<div class="input_area">
									<div class=" highlight hl-ipython3">
											<pre><span class="n">min_purchase</span> <span class="o">=</span> <span class="n">retail_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'CustomerID'</span><span class="p">)</span><span class="o">.</span><span class="n">InvoiceDate</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">min_purchase</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'CustomerID'</span><span class="p">,</span><span class="s1">'MinPurchaseDate'</span><span class="p">]</span>
<span class="n">min_purchase</span><span class="p">[</span><span class="s1">'FirstPurchasePeriod'</span><span class="p">]</span> <span class="o">=</span> <span class="n">min_purchase</span><span class="p">[</span><span class="s1">'MinPurchaseDate'</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">'%Y-%m'</span><span class="p">))</span>
<span class="n">min_purchase</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span></pre>
									</div>
									<div class="image" style="width: 400px; height: auto; max-width: 100%;">
										<img alt="sales dataframe" src="img/minpur.jpg" class="center-block" style="width: 400px; height: auto; max-width: 100%;"/>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row customers">
				<div class="col-md-10 column-in-center">
					<p>Now merge first purchase date column to main dataframe.</p>
					<div class="cell border-box-sizing code_cell rendered">
						<div class="input">
							<div class="inner_cell">
								<div class="input_area">
									<div class=" highlight hl-ipython3">
											<pre><span class="n">first_purchase</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">retail_data</span><span class="p">,</span> <span class="n">min_purchase</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s1">'CustomerID'</span><span class="p">)</span>
<span class="n">first_purchase</span><span class="o">.</span><span class="n">head</span><span class="p">()</span></pre>
									</div>
									<div class="image" style="width: 1236px; height: auto; max-width: 100%;">
										<img alt="sales dataframe" src="img/frst_pur.jpg" class="center-block" style="width: 1236px; height: auto; max-width: 100%;"/>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row customers">
				<div class="col-md-10 column-in-center">
					<p>Create a column called UserType and assign New or Existing.
						If customer's invoice period is greater then the first purchase then they are a returning customer.</p>
					<div class="cell border-box-sizing code_cell rendered">
						<div class="input">
							<div class="inner_cell">
								<div class="input_area">
									<div class=" highlight hl-ipython3">
											<pre><span class="n">first_purchase</span><span class="p">[</span><span class="s1">'UserType'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'New'</span>
<span class="n">first_purchase</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">first_purchase</span><span class="p">[</span><span class="s1">'InvoicePeriod'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">first_purchase</span><span class="p">[</span><span class="s1">'FirstPurchasePeriod'</span><span class="p">],</span><span class="s1">'UserType'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Existing'</span>
<span class="n">first_purchase</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span></pre>
									</div>
									<div class="image" style="width: 1236px; height: auto; max-width: 100%;">
										<img alt="sales dataframe" src="img/user_type.jpg" class="center-block" style="width: 1236px; height: auto; max-width: 100%;"/>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row customers">
				<div class="col-md-10 column-in-center">
					<p>Create a dataframe with Revenue per month for each user type</p>
					<div class="cell border-box-sizing code_cell rendered">
						<div class="input">
							<div class="inner_cell">
								<div class="input_area">
									<div class=" highlight hl-ipython3">
										<pre><span class="n">user_type_revenue</span> <span class="o">=</span> <span class="n">first_purchase</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">'InvoicePeriod'</span><span class="p">,</span> <span class="s1">'UserType'</span><span class="p">])[</span><span class="s1">'Revenue'</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">user_type_revenue</span> <span class="o">=</span> <span class="n">user_type_revenue</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">user_type_revenue</span><span class="o">.</span><span class="n">index</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">24</span><span class="p">]])</span>
<span class="n">user_type_revenue</span></pre>
									</div>
									<div class="image" style="width: 325px; height: auto; max-width: 100%;">
										<img alt="sales dataframe" src="img/user_type_revenue.jpg" class="center-block" style="width: 325px; height: auto; max-width: 100%;"/>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row customers">
				<div class="col-md-10 column-in-center">
					<p>Graph new and existing customers revenue each month. 
						Existing customers account for most of the revenue.</p>
					<div class="cell border-box-sizing code_cell rendered">
						<div class="input">
							<div class="inner_cell">
								<div class="input_area">
									<div class=" highlight hl-ipython3">
										<pre><span class="n">ne_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">user_type_revenue</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">"UserType == 'Existing'"</span><span class="p">)[</span><span class="s1">'InvoicePeriod'</span><span class="p">],</span>
		      <span class="n">y</span> <span class="o">=</span> <span class="n">user_type_revenue</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">"UserType == 'Existing'"</span><span class="p">)[</span><span class="s1">'Revenue'</span><span class="p">], </span><span class="n">name</span> <span class="o">=</span> <span class="s1">'Existing'</span><span class="p">),</span>
	
	   <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">user_type_revenue</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">"UserType == 'New'"</span><span class="p">)[</span><span class="s1">'InvoicePeriod'</span><span class="p">],</span>
		      <span class="n">y</span> <span class="o">=</span> <span class="n">user_type_revenue</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">"UserType == 'New'"</span><span class="p">)[</span><span class="s1">'Revenue'</span><span class="p">],</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">'New'</span><span class="p">)]</span>

<span class="n">plot_layout</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">xaxis</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">'Date'</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">'category'</span><span class="p">),</span>
			<span class="n">yaxis</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'title'</span><span class="p">:</span><span class="s1">'Revenue $'</span><span class="p">},</span>
			<span class="n">title</span> <span class="o">=</span> <span class="s1">'New vs. Existing Customer Revenue Comparison'</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">ne_data</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">plot_layout</span><span class="p">)</span>
<span class="n">pyoff</span><span class="o">.</span><span class="n">iplot</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span></pre>
									</div>
									<div class="image" style="width: 1236px; height: auto; max-width: 100%;">
										<img alt="sales dataframe" src="img/nw_exst_graph.jpg" class="center-block" style="width: 1236px; height: auto; max-width: 100%;"/>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row customers">
				<div class="col-md-10 column-in-center">
					<p>jCalculate new customer ratio and create a dataframe that shows new user ratio.  
						Drop December 2011 data since it is incomplete, drop NA, and January 2011 since all the customers were new.</p>
					<div class="cell border-box-sizing code_cell rendered">
						<div class="input">
							<div class="inner_cell">
								<div class="input_area">
									<div class=" highlight hl-ipython3">
										<pre><span class="n">newUser_ratio</span> <span class="o">=</span> <span class="n">first_purchase</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">"UserType == 'New'"</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">'InvoicePeriod'</span><span class="p">])[</span><span class="s1">'CustomerID'</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span> \
		<span class="o">/</span> <span class="n">first_purchase</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">"UserType == 'Existing'"</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">'InvoicePeriod'</span><span class="p">])[</span><span class="s1">'CustomerID'</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span> \
		<span class="o">*</span> <span class="mi">100</span>
<span class="n">newUser_ratio</span> <span class="o">=</span> <span class="n">newUser_ratio</span><span class="o">.</span><span class="n">round</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">newUser</span> <span class="o">=</span> <span class="n">newUser_ratio</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">customers</span><span class="o">.</span><span class="n">index</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">]])</span>
<span class="n">newUser</span></pre>
									</div>
									<div class="image" style="width: 250px; height: auto; max-width: 100%;">
										<img alt="sales dataframe" src="img/nw_cust.jpg" class="center-block" style="width: 250px; height: auto; max-width: 100%;"/>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row customers">
				<div class="col-md-10 column-in-center">
					<p>Graph new customer ratio by month. 
						New customers are declining, but picked up a little in September.</p>
					<div class="cell border-box-sizing code_cell rendered">
						<div class="input">
							<div class="inner_cell">
								<div class="input_area">
									<div class=" highlight hl-ipython3">
										<pre><span class="n">ncr_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">go</span><span class="o">.</span><span class="n">Bar</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">newUser</span><span class="p">[</span><span class="s1">'InvoicePeriod'</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span> <span class="n">newUser</span><span class="p">[</span><span class="s1">'CustomerID'</span><span class="p">])]</span>

<span class="n">plot_layout</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">xaxis</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">'Date'</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">'category'</span><span class="p">),</span> 
			<span class="n">yaxis</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'title'</span><span class="p">:</span><span class="s1">'Percent %'</span><span class="p">},</span>
			<span class="n">title</span> <span class="o">=</span> <span class="s1">'New Customer Ratio'</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">ncr_data</span><span class="p">,</span> <span class="n">layout</span> <span class="o">=</span> <span class="n">plot_layout</span><span class="p">)</span>
<span class="n">pyoff</span><span class="o">.</span><span class="n">iplot</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span></pre>
									</div>
									<div class="image" style="width: 1236px; height: auto; max-width: 100%;">
										<img alt="sales dataframe" src="img/nw_cust_graph.jpg" class="center-block" style="width: 1236px; height: auto; max-width: 100%;"/>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row customers">
				<div class="col-md-10 column-in-center">
					<p> To calculate cohort based retention rate. Identify which customer is active by looking at their revenue each month.</p>
					<div class="cell border-box-sizing code_cell rendered">
						<div class="input">
							<div class="inner_cell">
								<div class="input_area">
									<div class=" highlight hl-ipython3">
											<pre><span class="n">user_purchase</span> <span class="o">=</span> <span class="n">retail_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">'CustomerID'</span><span class="p">,</span> <span class="s1">'InvoicePeriod'</span><span class="p">])[</span><span class="s1">'Revenue'</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">user_purchase</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre>
									</div>
									<div class="image" style="width: 330px; height: auto; max-width: 100%;">
										<img alt="sales dataframe" src="img/ch_reten.jpg" class="center-block" style="width: 330px; height: auto; max-width: 100%;"/>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row customers">
				<div class="col-md-10 column-in-center">
					<p>Create retention matrix with crosstab function which builds a cross-tabulation 
						table that can show the frequency with which certain group appear.</p>
					<div class="cell border-box-sizing code_cell rendered">
						<div class="input">
							<div class="inner_cell">
								<div class="input_area">
									<div class=" highlight hl-ipython3">
										<pre><span class="n">retention</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">user_purchase</span><span class="p">[</span><span class="s1">'CustomerID'</span><span class="p">],</span> <span class="n">user_purchase</span><span class="p">[</span><span class="s1">'InvoicePeriod'</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">retention</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre>
									</div>
									<div class="image" style="width: 1236px; height: auto; max-width: 100%;">
										<img alt="sales dataframe" src="img/reten.jpg" class="center-block" style="width: 1236px; height: auto; max-width: 100%;"/>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row customers">
				<div class="col-md-10 column-in-center">
					<p>Create an array of dictionary which keeps retained & total customer 
						count for each month and convert the array to dataframe. Then calculate retention rate.</p>
					<div class="cell border-box-sizing code_cell rendered">
						<div class="input">
							<div class="inner_cell">
								<div class="input_area">
									<div class=" highlight hl-ipython3">
										<pre><span class="n">months</span> <span class="o">=</span> <span class="n">retention</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
<span class="n">retention_array</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">months</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
	<span class="n">retention_data</span> <span class="o">=</span> <span class="p">{}</span>
	<span class="n">selected_month</span> <span class="o">=</span> <span class="n">months</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
	<span class="n">prev_month</span> <span class="o">=</span> <span class="n">months</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
	<span class="n">retention_data</span><span class="p">[</span><span class="s1">'InvoicePeriod'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">selected_month</span><span class="p">)</span>
	<span class="n">retention_data</span><span class="p">[</span><span class="s1">'TotalCustomerCount'</span><span class="p">]</span> <span class="o">=</span> <span class="n">retention</span><span class="p">[</span><span class="n">selected_month</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
	<span class="n">retention_data</span><span class="p">[</span><span class="s1">'RetainedCustomerCount'</span><span class="p">]</span> <span class="o">=</span> <span class="n">retention</span><span class="p">[(</span><span class="n">retention</span><span class="p">[</span><span class="n">selected_month</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
						  <span class="o">&amp;</span> <span class="p">(</span><span class="n">retention</span><span class="p">[</span><span class="n">prev_month</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)][</span><span class="n">selected_month</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
	<span class="n">retention_array</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">retention_data</span><span class="p">)</span>

<span class="n">retention</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">retention_array</span><span class="p">)</span>
<span class="n">retention</span><span class="p">[</span><span class="s1">'RetentionRate%'</span><span class="p">]</span> <span class="o">=</span> <span class="n">retention</span><span class="p">[</span><span class="s1">'RetainedCustomerCount'</span><span class="p">]</span> <span class="o">/</span> <span class="n">retention</span><span class="p">[</span><span class="s1">'TotalCustomerCount'</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">retention_rate</span> <span class="o">=</span> <span class="n">retention</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">retention</span><span class="o">.</span><span class="n">index</span><span class="p">[[</span><span class="mi">10</span><span class="p">]])</span><span class="o">.</span><span class="n">round</span><span class="p">()</span>
<span class="n">retention_rate</span>
</pre>
									</div>
									<div class="image" style="width: 500px; height: auto; max-width: 100%;">
										<img alt="sales dataframe" src="img/reten_rt.jpg" class="center-block" style="width: 500px; height: auto; max-width: 100%;"/>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row customers">
				<div class="col-md-10 column-in-center">
					<p>Graph retention rate.  Retention rates has been growing with some lows that could be due to seasonality.</p>
					<div class="cell border-box-sizing code_cell rendered">
						<div class="input">
							<div class="inner_cell">
								<div class="input_area">
									<div class=" highlight hl-ipython3">
										<pre><span><span class="n">rr_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">retention_rate</span><span class="p">[</span><span class="s1">'InvoicePeriod'</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span> <span class="n">retention_rate</span><span class="p">[</span><span class="s1">'RetentionRate%'</span><span class="p">])]</span>

<span class="n">plot_layout</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">xaxis</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s1">'Date'</span><span class="p">,</span> <span class="nb">type</span> <span class="o">=</span> <span class="s1">'category'</span><span class="p">),</span> 
			<span class="n">yaxis</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'title'</span><span class="p">:</span><span class="s1">'Retention %'</span><span class="p">},</span>
			<span class="n">title</span> <span class="o">=</span> <span class="s1">'Monthly Retention Rate'</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">rr_data</span><span class="p">,</span> <span class="n">layout</span> <span class="o">=</span> <span class="n">plot_layout</span><span class="p">)</span>
<span class="n">pyoff</span><span class="o">.</span><span class="n">iplot</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre>		   
									</div>
									<div class="image" style="width: 1236px; height: auto; max-width: 100%;">
										<img alt="sales dataframe" src="img/reten_rt_graph.jpg" class="center-block" style="width: 1236px; height: auto; max-width: 100%;"/>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row customers">
				<div class="col-md-10 column-in-center">
					<p>Cohort month is the first month a specific customer shopped at this online retailer. 
						<br>Cohort index is the month difference between invoice month and cohort month for each row.
						<br>Deduction allows you to know the month lapse between first transaction and the last transaction.</p>
					<div class="cell border-box-sizing code_cell rendered">
						<div class="input">
							<div class="inner_cell">
								<div class="input_area">
									<div class=" highlight hl-ipython3">
										<pre><span class="k">def</span> <span class="nf">get_month</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
	<span class="k">return</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">retail_data</span><span class="p">[</span><span class="s1">'InvoiceMonth'</span><span class="p">]</span> <span class="o">=</span> <span class="n">retail_data</span><span class="p">[</span><span class="s1">'InvoiceDate'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">get_month</span><span class="p">)</span>
<span class="n">retail_data</span><span class="p">[</span><span class="s1">'CohortMonth'</span><span class="p">]</span> <span class="o">=</span> <span class="n">retail_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'CustomerID'</span><span class="p">)[</span><span class="s1">'InvoiceMonth'</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="s1">'min'</span><span class="p">)</span>
</pre>
									</div>
								</div>
								<div class="input_area">
									<div class=" highlight hl-ipython3"><pre><span class="k">def</span> <span class="nf">get_date</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">column</span><span class="p">):</span>
	<span class="n">year</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>
	<span class="n">month</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span>
	<span class="n">day</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span>
	<span class="k">return</span> <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span>
<span class="n">invoice_year</span><span class="p">,</span> <span class="n">invoice_month</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">get_date</span><span class="p">(</span><span class="n">retail_data</span><span class="p">,</span> <span class="s1">'InvoiceMonth'</span><span class="p">)</span>
<span class="n">cohort_year</span><span class="p">,</span> <span class="n">cohort_month</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">get_date</span><span class="p">(</span><span class="n">retail_data</span><span class="p">,</span> <span class="s1">'CohortMonth'</span><span class="p">)</span>
<span class="n">year_diff</span> <span class="o">=</span> <span class="n">invoice_year</span> <span class="o">-</span> <span class="n">cohort_year</span>
<span class="n">month_diff</span> <span class="o">=</span> <span class="n">invoice_month</span> <span class="o">-</span> <span class="n">cohort_month</span>
<span class="n">retail_data</span><span class="p">[</span><span class="s1">'CohortIndex'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">year_diff</span> <span class="o">*</span> <span class="mi">12</span> <span class="o">+</span> <span class="n">month_diff</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">retail_data</span><span class="p">[</span><span class="s1">'CohortMonth'</span><span class="p">]</span> <span class="o">=</span> <span class="n">retail_data</span><span class="p">[</span><span class="s1">'CohortMonth'</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">'%Y-%m'</span><span class="p">))</span>
<span class="n">retail_data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre>
								</div>
								<div class="image" style="width: 1236px; height: auto; max-width: 100%;">
									<img alt="sales dataframe" src="img/cht_reten.jpg" class="center-block" style="width: 1236px; height: auto; max-width: 100%;"/>
								</div>
									
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="row customers">
			<div class="col-md-10 column-in-center">
				<p>Group cohortmonth, cohortindex and customerid to a dataframe and using pivot table 
					function to group into a two-dimensional table 
					to provide multidimensional summarization of cohorts.</p>
					<p>Indect is CohortMonth first column in the chart are active customers by a specific 
					month following column show the percentage of returning custmers.</p>
				<div class="cell border-box-sizing code_cell rendered">
					<div class="input">
						<div class="inner_cell">
							<div class="input_area">
								<div class=" highlight hl-ipython3">
									<pre><span></span><span class="n">cohort_data</span> <span class="o">=</span> <span class="n">retail_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">'CohortMonth'</span><span class="p">,</span> <span class="s1">'CohortIndex'</span><span class="p">]</span><span class="p">)[</span><span class="s1">'CustomerID'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="o">.</span><span class="n">nunique</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">cohort_count</span> <span class="o">=</span> <span class="n">cohort_data</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span> <span class="o">=</span> <span class="s1">'CohortMonth'</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="s1">'CohortIndex'</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="s1">'CustomerID'</span><span class="p">)</span>

<span class="n">cohort_size</span> <span class="o">=</span> <span class="n">cohort_count</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">retention</span> <span class="o">=</span> <span class="n">cohort_count</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">cohort_size</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">retention</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
</pre>		   
								</div>
								<div class="image" style="width: 650px; height: auto; max-width: 100%;">
									<img alt="sales dataframe" src="img/reten_cohrt.jpg" class="center-block" style="width: 650px; height: auto; max-width: 100%;"/>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="row customers">
			<div class="col-md-10 column-in-center">
				<p>Graph a heatmap to show cohorts of the retention rate.</p>
				<div class="cell border-box-sizing code_cell rendered">
					<div class="input">
						<div class="inner_cell">
							<div class="input_area">
								<div class=" highlight hl-ipython3">
									<pre><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Cohort Based Retention Rate'</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">retention</span><span class="p">,</span> 
			<span class="n">annot</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> 
			<span class="n">fmt</span> <span class="o">=</span> <span class="s1">'.0%'</span><span class="p">,</span> 
			<span class="n">vmin</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
			<span class="n">vmax</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
			<span class="n">cmap</span> <span class="o">=</span> <span class="s2">"YlGnBu"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></pre>
								</div>
								<div class="image" style="width: 1236px; height: auto; max-width: 100%;">
									<img alt="sales dataframe" src="img/reten_cohrt_graph.jpg" class="center-block" style="width: 1236px; height: auto; max-width: 100%;"/>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		</div>
	</section>
	
	<!-- Customer Segmentation -->
	<section id="customerseg" class="section section-padded">
		<div class="container">
			<div class="row text-center title">
				<h2>Customer Segmentation</h2>
				<h4 class="light muted"></h4>
			</div>
			<div class="row customerseg">
				<div class="col-md-10 column-in-center">
					<p>RFM is a customer segmentation technique that uses past purchase behavior to divide customers into groups.</p>
					<p>RECENCY (R): Days since last purchase - Score of 1 goes to customers who bought most recently
					<br>FREQUENCY (F): Total number of purchases - Score of 1 goes to customers who placed the highest number of orders
					<br>MONETARY VALUE (M): Total money this customer spent - Score of 1 goes to customers who spent the most in terms of value</p>
					<p>Some research indicats that customer clusters vary by geography,
						so this analysis will be focus on United Kingdom customers since it is the largest.</p>
					<div class="cell border-box-sizing code_cell rendered">
						<div class="input">
							<div class="inner_cell">
								<div class="input_area">
									<div class=" highlight hl-ipython3">
										<pre><span class="n">uk_data</span><span class="p">[</span><span class="s1">'Revenue'</span><span class="p">]</span> <span class="o">=</span> <span class="n">uk_data</span><span class="p">[</span><span class="s1">'Quantity'</span><span class="p">]</span> <span class="o">*</span> <span class="n">uk_data</span><span class="p">[</span><span class="s1">'UnitPrice'</span><span class="p">]</span>
<span class="n">uk_data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span></pre>
									</div>
									<div class="image" style="width: 1236px; height: auto; max-width: 100%;">
										<img alt="sales dataframe" src="img/uk_data.jpg" class="center-block" style="width: 1236px; height: auto; max-width: 100%;"/>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row customerseg">
				<div class="col-md-10 column-in-center">
					<p>Calculate RFM values by grouping the data for each customer & 
						aggregate it for each recency, frequency, and monetary value, then rename the columns.</p>
					<div class="cell border-box-sizing code_cell rendered">
						<div class="input">
							<div class="inner_cell">
								<div class="input_area">
									<div class=" highlight hl-ipython3">
										<pre><span class="n">uk_data</span><span class="p">[</span><span class="s1">'InvoiceDate'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">uk_data</span><span class="p">[</span><span class="s1">'InvoiceDate'</span><span class="p">])</span>

<span class="n">NOW</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2011</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>

<span class="n">rfm</span> <span class="o">=</span> <span class="n">uk_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'CustomerID'</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">'InvoiceDate'</span> <span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">NOW</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">())</span><span class="o">.</span><span class="n">days</span><span class="p">,</span> 
					<span class="s1">'InvoiceNo'</span> <span class="p">:</span> <span class="s1">'count'</span><span class="p">,</span> <span class="s1">'Revenue'</span> <span class="p">:</span> <span class="s1">'sum'</span><span class="p">})</span>

<span class="n">rfm</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'InvoiceDate'</span> <span class="p">:</span> <span class="s1">'Recency'</span><span class="p">,</span> <span class="s1">'InvoiceNo'</span> <span class="p">:</span> <span class="s1">'Frequency'</span><span class="p">,</span> <span class="s1">'Revenue'</span> <span class="p">:</span> <span class="s1">'Monetary'</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">rfm</span><span class="o">.</span><span class="n">head</span><span class="p">()</span></pre>
									</div>
									<div class="image" style="width: 350px; height: auto; max-width: 100%;">
										<img alt="sales dataframe" src="img/rfm_df.jpg" class="center-block" style="width: 350px; height: auto; max-width: 100%;"/>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row customersseg">
				<div class="col-md-10 column-in-center">
					<p>Cause these are continuous values, we can use the quantile values and divide them into 4 groups
						create labels and assign them to percentile groups.</p>
						<p>Use qcut() to put variable into equal-sized bins. Make a new column for group labels and 
							total the sum of the three values to get RFM_Value</p>
					<div class="cell border-box-sizing code_cell rendered">
						<div class="input">
							<div class="inner_cell">
								<div class="input_area">
									<div class=" highlight hl-ipython3">
										<pre><span class="n">r_labels</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">f_labels</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">m_labels</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">r_groups</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">qcut</span><span class="p">(</span><span class="n">rfm</span><span class="o">.</span><span class="n">Recency</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">r_labels</span><span class="p">)</span>
<span class="n">f_groups</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">qcut</span><span class="p">(</span><span class="n">rfm</span><span class="o">.</span><span class="n">Frequency</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">f_labels</span><span class="p">)</span>
<span class="n">m_groups</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">qcut</span><span class="p">(</span><span class="n">rfm</span><span class="o">.</span><span class="n">Monetary</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">m_labels</span><span class="p">)</span>
</pre>
									</div>
								</div>
								<div class="input_area">
									<div class=" highlight hl-ipython3">
										<pre><span class="n">rfm</span><span class="p">[</span><span class="s1">'R'</span><span class="p">]</span> <span class="o">=</span> <span class="n">r_groups</span><span class="o">.</span><span class="n">values</span>
<span class="n">rfm</span><span class="p">[</span><span class="s1">'F'</span><span class="p">]</span> <span class="o">=</span> <span class="n">f_groups</span><span class="o">.</span><span class="n">values</span>
<span class="n">rfm</span><span class="p">[</span><span class="s1">'M'</span><span class="p">]</span> <span class="o">=</span> <span class="n">m_groups</span><span class="o">.</span><span class="n">values</span>

<span class="n">rfm</span><span class="p">[</span><span class="s1">'RFM_Score'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rfm</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">'R'</span><span class="p">])</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">'F'</span><span class="p">])</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">'M'</span><span class="p">]),</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">rfm</span><span class="p">[</span><span class="s1">'RFM_Value'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rfm</span><span class="p">[[</span><span class="s1">'R'</span><span class="p">,</span> <span class="s1">'F'</span><span class="p">,</span> <span class="s1">'M'</span><span class="p">]]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">rfm</span><span class="o">.</span><span class="n">head</span><span class="p">()</span></pre>
									</div>
									<div class="image" style="width:500px; height: auto; max-width: 100%;">
										<img alt="sales dataframe" src="img/rfm_score.jpg" class="center-block" style="width: 500px; height: auto; max-width: 100%;"/>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row customerseg">
				<div class="col-md-10 column-in-center">
					<p>RFM_Value can be used to categorize customers assign labels from total score.</p>
					<div class="cell border-box-sizing code_cell rendered">
						<div class="input">
							<div class="inner_cell">
								<div class="input_area">
									<div class=" highlight hl-ipython3">
										<pre><span class="n">score_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Best Customers'</span><span class="p">,</span> <span class="s1">'Loyal Customers'</span><span class="p">,</span> <span class="s1">'Big Spenders'</span><span class="p">,</span> <span class="s1">'Almost Lost'</span><span class="p">,</span> <span class="s1">'Lost Customers'</span><span class="p">,</span> <span class="s1">'Lost Cheap Customers'</span><span class="p">]</span>
<span class="n">score_groups</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">qcut</span><span class="p">(</span><span class="n">rfm</span><span class="o">.</span><span class="n">RFM_Value</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">score_labels</span><span class="p">)</span>
<span class="n">rfm</span><span class="p">[</span><span class="s1">'RFM_Segment'</span><span class="p">]</span> <span class="o">=</span> <span class="n">score_groups</span><span class="o">.</span><span class="n">values</span>
<span class="n">rfm</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span></pre>
									</div>
									<div class="image" style="width: 650px; height: auto; max-width: 100%;">
										<img alt="rfm_segment" src="img/rfm_segment.jpg" class="center-block" style="width: 650px; height: auto; max-width: 100%;"/>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row customerseg">
				<div class="col-md-10 column-in-center">
					<p>Graph each RFM Segment.  38% of customers are either loyal or the best customers. 
						There are 21% of lost customers who can now be identified and retarget with a come back campaign.
					</p>
					<div class="cell border-box-sizing code_cell rendered">
						<div class="input">
							<div class="inner_cell">
								<div class="input_area">
									<div class=" highlight hl-ipython3">
										<pre><span class="n">segment_counts</span> <span class="o">=</span> <span class="n">rfm</span><span class="p">[</span><span class="s1">'RFM_Segment'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Total Number of Customers in RFM Segments'</span><span class="p">)</span>

<span class="n">bars</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">segment_counts</span><span class="p">)),</span> <span class="n">segment_counts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'silver'</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_frame_on</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">segment_counts</span><span class="p">)))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">segment_counts</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">bar</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bars</span><span class="p">):</span>
	<span class="n">value</span> <span class="o">=</span> <span class="n">bar</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span>
	
	<span class="k">if</span> <span class="n">segment_counts</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'Best Customers'</span><span class="p">,</span> <span class="s1">'Loyal Customers'</span><span class="p">]:</span> <span class="n">bar</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">'firebrick'</span><span class="p">)</span>
		
	<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">bar</span><span class="o">.</span><span class="n">get_y</span><span class="p">()</span> <span class="o">+</span> <span class="n">bar</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
		<span class="s1">'</span><span class="si">{:,}</span><span class="s1"> (</span><span class="si">{:}</span><span class="s1">%)'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="o">*</span><span class="mi">100</span><span class="o">/</span><span class="n">segment_counts</span><span class="o">.</span><span class="n">sum</span><span class="p">())))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
									</div>
									<div class="image" style="width: 1236px; height: auto; max-width: 100%;">
										<img alt="rfm_segment" src="img/rfm_segment_graph.jpg" class="center-block" style="width: 1236px; height: auto; max-width: 100%;"/>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>

		</div>
	<div class="cut cut-bottom"></div>
	</section>
	
	<!-- Sales Forcast -->
	<section id="salesfor" class="section gray-bg">
		<div class="container">
			<div class="row title text-center">
				<h2 class="margin-top">Sales Forcast</h2>
				<h4 class="light muted"></h4>
			</div>
			<div class="row salesfor">
				<div class="col-md-10 column-in-center">
					<p>Using UK revenue rename the columns to ds and y in order to comply with the Prophet API</p>
					<div class="cell border-box-sizing code_cell rendered">
						<div class="input">
							<div class="inner_cell">
								<div class="input_area">
									<div class=" highlight hl-ipython3">
										<pre><span class="n">uk_revenue</span> <span class="o">=</span> <span class="n">uk_data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"InvoiceMonth"</span> <span class="p">:</span> <span class="s1">'ds'</span><span class="p">,</span> <span class="s2">"Revenue"</span> <span class="p">:</span> <span class="s1">'y'</span><span class="p">})</span>
<span class="n">uk_revenue</span><span class="o">.</span><span class="n">shape</span>
<span class="n">uk_revenue</span><span class="o">.</span><span class="n">head</span><span class="p">()</span></pre>
									</div>
									<div class="image" style="width: 239px; height: auto; max-width: 100%;">
										<img alt="sales dataframe" src="img/fbprophet_df.jpg" class="center-block" style="width: 239px; height: auto; max-width: 100%;"/>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>

			<div class="row salesfor">
				<div class="col-md-10 column-in-center">
					<p>Check tail of future to ensure the prediction dates are 180 days out.</p>
					<div class="cell border-box-sizing code_cell rendered">
						<div class="input">
							<div class="inner_cell">
								<div class="input_area">
									<div class=" highlight hl-ipython3">
										<pre><span class="n">model</span> <span class="o">=</span> <span class="n">Prophet</span><span class="p">(</span><span class="n">yearly_seasonality</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">weekly_seasonality</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">daily_seasonality</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">add_country_holidays</span><span class="p">(</span><span class="n">country_name</span><span class="o">=</span><span class="s1">'UK'</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">uk_revenue</span><span class="p">)</span>
<span class="n">future</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">make_future_dataframe</span><span class="p">(</span><span class="n">periods</span> <span class="o">=</span> <span class="mi">180</span><span class="p">)</span></pre>
									</div>
								</div>
								<div class="input_area">
									<div class=" highlight hl-ipython3">
										<pre><span class="n">future</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span></pre>
									</div>
									<div class="image" style="width: 185px; height: auto; max-width: 100%;">
									<img alt="sales dataframe" src="img/fb_fut_tail.jpg" class="center-block" style="width: 185px; height: auto; max-width: 100%;"/>
								</div>	
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="row salesfor">
			<div class="col-md-10 column-in-center">
				<p>Predict method to make future predictions. 
					This will generate a dataframe with a yhat column that will contain the predictions.</p>
				<div class="cell border-box-sizing code_cell rendered">
					<div class="input">
						<div class="inner_cell">
							<div class="input_area">
								<div class=" highlight hl-ipython3">
									<pre><span class="n">forecast</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">future</span><span class="p">)</span>
<span class="n">forecast</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre>
								</div>
								<div class="image" style="width: 1236px; height: auto; max-width: 100%;">
									<img alt="sales dataframe" src="img/fb_forecast.jpg" class="center-block" style="width: 1236px; height: auto; max-width: 100%;"/>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="row salesfor">
			<div class="col-md-10 column-in-center">
				<p>Plot forcast. Blue line represents the predicted values 
					shaded blue area is the error of the forecast and the black dots represents the data in dataset.</p>
				<div class="cell border-box-sizing code_cell rendered">
					<div class="input">
						<div class="inner_cell">
							<div class="input_area">
								<div class=" highlight hl-ipython3">
									<pre><span class="n">plot2</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">forecast</span><span class="p">)</span></pre>
								</div>
								<div class="image" style="width: 1080px; height: auto; max-width: 100%;">
									<img alt="sales dataframe" src="img/fb_forecast_graph.jpg" class="center-block" style="width: 1080px; height: auto; max-width: 100%;"/>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="row salesfor">
			<div class="col-md-10 column-in-center">
				<p>Plots the trend, yearly, weekly and daily seasonality.</p>
				<div class="cell border-box-sizing code_cell rendered">
					<div class="input">
						<div class="inner_cell">
							<div class="input_area">
								<div class=" highlight hl-ipython3">
									<pre><span class="n">plot3</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot_components</span><span class="p">(</span><span class="n">forecast</span><span class="p">)</span></pre>
								</div>
								<div class="image" style="width: 550px; height: auto; max-width: 100%;">
									<img alt="sales dataframe" src="img/fb_plot_components.jpg" class="center-block" style="width: 550px; height: auto; max-width: 100%;"/>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="row salesfor">
				<div class="col-md-10 column-in-center">
					<p>Create a metric dataframe to measure accuracy of model. 
						This dataset is not ideal for timeseries modeling.</p>
						</p>
					<div class="cell border-box-sizing code_cell rendered">
						<div class="input">
							<div class="inner_cell">
								<div class="input_area">
									<div class=" highlight hl-ipython3">
										<pre><span></span><span class="n">metric_df</span> <span class="o">=</span> <span class="n">forecast</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">'ds'</span><span class="p">)[[</span><span class="s1">'yhat'</span><span class="p">]]</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">uk_revenue</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">'ds'</span><span class="p">)</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span></span><span class="n">metric_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">metric_df</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre>
									</div>
									<div class="image" style="width: 375px; height: auto; max-width: 100%;">
										<img alt="sales dataframe" src="img/fb_metric_df.jpg" class="center-block" style="width: 375px; height: auto; max-width: 100%;"/>
									</div>
									<br>
									<div class="image" style="width: 400px; height: auto; max-width: 100%;">
										<img alt="sales dataframe" src="img/fb_metric.jpg" class="center-block" style="width: 400px; height: auto; max-width: 100%;"/>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>

	<!-- Footer -->
	<footer>
		<div class="container">
			<div class="row">
			</div>
			<div class="row bottom-footer text-center-mobile">
				<div class="col-sm-8">
					<p>&copy; 2019 Yen Duong.</p>
				</div>
				<div class="col-sm-4 text-right text-center-mobile">
					<ul class="social-footer">
						<li><a href="https://www.linkedin.com/in/yenduong8/" target="_blank"><i class="fa fa-linkedin"></i></a></li>
						<li><a href="https://github.com/yduong3" target="_blank"><i class="fa fa-github"></i></a></li>
						<li><a href="https://mailto:yduong28@gmail.com.com" target="_blank"><i class="fa fa-envelope-square"></i></a></li>
					</ul>
				</div>
			</div>
		</div>
	</footer>
	<!-- Holder for mobile navigation -->
	<div class="mobile-nav">
		<ul>
		</ul>
		<a href="#" class="close-link"><i class="arrow_up"></i></a>
	</div>
	<!-- Scripts -->
	<script src="js/jquery-1.11.1.min.js"></script>
	<script src="js/owl.carousel.min.js"></script>
	<script src="js/bootstrap.min.js"></script>
	<script src="js/wow.min.js"></script>
	<script src="js/typewriter.js"></script>
	<script src="js/jquery.onepagenav.js"></script>
	<script src="js/main.js"></script>
</body>

</html>